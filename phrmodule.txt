This is copy of phrmodule with enhancements.